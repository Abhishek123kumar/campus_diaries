{"ast":null,"code":"import _objectSpread from\"/Users/abhishekkumar/Desktop/firebase-blog-master/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/abhishekkumar/Desktop/firebase-blog-master/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/abhishekkumar/Desktop/firebase-blog-master/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/abhishekkumar/Desktop/firebase-blog-master/node_modules/@babel/runtime/regenerator/index.js\";import{collection,endAt,endBefore,getDocs,limit,limitToLast,orderBy,query,startAfter}from\"firebase/firestore\";import React from\"react\";import{useEffect}from\"react\";import{useState}from\"react\";import BlogSection from\"../components/BlogSection\";import Pagination from\"../components/Pagination\";import Spinner from\"../components/Spinner\";import{db}from\"../firebase\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Blogs=function Blogs(_ref){var setActive=_ref.setActive;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),blogs=_useState4[0],setBlogs=_useState4[1];var _useState5=useState(1),_useState6=_slicedToArray(_useState5,2),currentPage=_useState6[0],setCurrentPage=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),lastVisible=_useState8[0],setLastVisible=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),noOfPages=_useState10[0],setNoOfPages=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),count=_useState12[0],setCount=_useState12[1];useEffect(function(){getBlogsData();getTotalBlogs();setActive(\"blogs\");},[]);if(loading){return/*#__PURE__*/_jsx(Spinner,{});}var getBlogsData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var blogRef,first,docSnapshot;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);blogRef=collection(db,\"blogs\");first=query(blogRef,orderBy(\"title\"),limit(4));_context.next=5;return getDocs(first);case 5:docSnapshot=_context.sent;setBlogs(docSnapshot.docs.map(function(doc){return _objectSpread({id:doc.id},doc.data());}));setCount(docSnapshot.size);setLastVisible(docSnapshot.docs[docSnapshot.docs.length-1]);setLoading(false);case 10:case\"end\":return _context.stop();}}},_callee);}));return function getBlogsData(){return _ref2.apply(this,arguments);};}();var getTotalBlogs=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var blogRef,docSnapshot,totalBlogs,totalPage;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:blogRef=collection(db,\"blogs\");_context2.next=3;return getDocs(blogRef);case 3:docSnapshot=_context2.sent;totalBlogs=docSnapshot.size;totalPage=Math.ceil(totalBlogs/4);setNoOfPages(totalPage);case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function getTotalBlogs(){return _ref3.apply(this,arguments);};}();var fetchMore=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var blogRef,nextBlogsQuery,nextBlogsSnaphot;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setLoading(true);blogRef=collection(db,\"blogs\");nextBlogsQuery=query(blogRef,orderBy(\"title\"),startAfter(lastVisible),limit(4));_context3.next=5;return getDocs(nextBlogsQuery);case 5:nextBlogsSnaphot=_context3.sent;setBlogs(nextBlogsSnaphot.docs.map(function(doc){return _objectSpread({id:doc.id},doc.data());}));setCount(nextBlogsSnaphot.size);setLastVisible(nextBlogsSnaphot.docs[nextBlogsSnaphot.docs.length-1]);setLoading(false);case 10:case\"end\":return _context3.stop();}}},_callee3);}));return function fetchMore(){return _ref4.apply(this,arguments);};}();var fetchPrev=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var blogRef,end,limitData,prevBlogsQuery,prevBlogsSnaphot;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:setLoading(true);blogRef=collection(db,\"blogs\");end=noOfPages!==currentPage?endAt(lastVisible):endBefore(lastVisible);limitData=noOfPages!==currentPage?limit(4):count<=4&&noOfPages%2===0?limit(4):limitToLast(4);prevBlogsQuery=query(blogRef,orderBy(\"title\"),end,limitData);_context4.next=7;return getDocs(prevBlogsQuery);case 7:prevBlogsSnaphot=_context4.sent;setBlogs(prevBlogsSnaphot.docs.map(function(doc){return _objectSpread({id:doc.id},doc.data());}));setCount(prevBlogsSnaphot.size);setLastVisible(prevBlogsSnaphot.docs[prevBlogsSnaphot.docs.length-1]);setLoading(false);case 12:case\"end\":return _context4.stop();}}},_callee4);}));return function fetchPrev(){return _ref5.apply(this,arguments);};}();var handlePageChange=function handlePageChange(value){if(value===\"Next\"){setCurrentPage(function(page){return page+1;});fetchMore();}else if(value===\"Prev\"){setCurrentPage(function(page){return page-1;});fetchPrev();}};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"blog-heading text-center py-2 mb-4\",children:\"Daily Blogs\"}),blogs===null||blogs===void 0?void 0:blogs.map(function(blog){return/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6\",children:/*#__PURE__*/_jsx(BlogSection,_objectSpread({},blog))},blog.id);})]}),/*#__PURE__*/_jsx(Pagination,{currentPage:currentPage,noOfPages:noOfPages,handlePageChange:handlePageChange})]})});};export default Blogs;","map":null,"metadata":{},"sourceType":"module"}