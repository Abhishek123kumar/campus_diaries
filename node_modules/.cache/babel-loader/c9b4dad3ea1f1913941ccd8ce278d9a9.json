{"ast":null,"code":"import _defineProperty from\"/Users/abhishekkumar/Desktop/firebase-blog-master/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _asyncToGenerator from\"/Users/abhishekkumar/Desktop/firebase-blog-master/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"/Users/abhishekkumar/Desktop/firebase-blog-master/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/abhishekkumar/Desktop/firebase-blog-master/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/abhishekkumar/Desktop/firebase-blog-master/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useEffect}from\"react\";import ReactTagInput from\"@pathofdev/react-tag-input\";import\"@pathofdev/react-tag-input/build/index.css\";import{db,storage}from\"../firebase\";import{useNavigate,useParams}from\"react-router-dom\";import{getDownloadURL,ref,uploadBytesResumable}from\"firebase/storage\";import{Editor}from\"@tinymce/tinymce-react\";import{addDoc,collection,getDoc,serverTimestamp,doc,updateDoc}from\"firebase/firestore\";import{toast}from\"react-toastify\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var initialState={title:\"\",tags:[],trending:\"no\",category:\"\",description:\"\",comments:[],likes:[]};var categoryOption=[\"Fashion\",\"Technology\",\"Food\",\"Politics\",\"Sports\",\"Business\"];var AddEditBlog=function AddEditBlog(_ref){var user=_ref.user,setActive=_ref.setActive;var _useState=useState(initialState),_useState2=_slicedToArray(_useState,2),form=_useState2[0],setForm=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),file=_useState4[0],setFile=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),progress=_useState6[0],setProgress=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),plainTextDescription=_useState8[0],setPlainTextDescription=_useState8[1];// Define state for plain text content\nvar _useParams=useParams(),id=_useParams.id;var navigate=useNavigate();var title=form.title,tags=form.tags,category=form.category,trending=form.trending,description=form.description;useEffect(function(){var uploadFile=function uploadFile(){var storageRef=ref(storage,file.name);var uploadTask=uploadBytesResumable(storageRef,file);uploadTask.on(\"state_changed\",function(snapshot){var progress=snapshot.bytesTransferred/snapshot.totalBytes*100;console.log(\"Upload is \"+progress+\"% done\");setProgress(progress);switch(snapshot.state){case\"paused\":console.log(\"Upload is paused\");break;case\"running\":console.log(\"Upload is running\");break;default:break;}},function(error){console.log(error);},function(){getDownloadURL(uploadTask.snapshot.ref).then(function(downloadUrl){toast.info(\"Image upload to firebase successfully\");setForm(function(prev){return _objectSpread(_objectSpread({},prev),{},{imgUrl:downloadUrl});});});});};file&&uploadFile();},[file]);useEffect(function(){id&&getBlogDetail();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[id]);var getBlogDetail=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var docRef,snapshot;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:docRef=doc(db,\"blogs\",id);_context.next=3;return getDoc(docRef);case 3:snapshot=_context.sent;if(snapshot.exists()){setForm(_objectSpread({},snapshot.data()));}setActive(null);case 6:case\"end\":return _context.stop();}}},_callee);}));return function getBlogDetail(){return _ref2.apply(this,arguments);};}();var handleChange=function handleChange(e){setForm(_objectSpread(_objectSpread({},form),{},_defineProperty({},e.target.name,e.target.value)));};var handleTags=function handleTags(tags){setForm(_objectSpread(_objectSpread({},form),{},{tags:tags}));};var handleTrending=function handleTrending(e){setForm(_objectSpread(_objectSpread({},form),{},{trending:e.target.value}));};var onCategoryChange=function onCategoryChange(e){setForm(_objectSpread(_objectSpread({},form),{},{category:e.target.value}));};var handleSubmit=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();if(!(category&&tags&&title&&description&&trending)){_context2.next=25;break;}if(id){_context2.next=14;break;}_context2.prev=3;_context2.next=6;return addDoc(collection(db,\"blogs\"),_objectSpread(_objectSpread({},form),{},{timestamp:serverTimestamp(),author:user.displayName,userId:user.uid}));case 6:toast.success(\"Blog created successfully\");_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](3);console.log(_context2.t0);case 12:_context2.next=23;break;case 14:_context2.prev=14;_context2.next=17;return updateDoc(doc(db,\"blogs\",id),_objectSpread(_objectSpread({},form),{},{timestamp:serverTimestamp(),author:user.displayName,userId:user.uid}));case 17:toast.success(\"Blog updated successfully\");_context2.next=23;break;case 20:_context2.prev=20;_context2.t1=_context2[\"catch\"](14);console.log(_context2.t1);case 23:_context2.next=26;break;case 25:return _context2.abrupt(\"return\",toast.error(\"All fields are mandatory to fill\"));case 26:navigate(\"/\");case 27:case\"end\":return _context2.stop();}}},_callee2,null,[[3,9],[14,20]]);}));return function handleSubmit(_x){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"container-fluid mb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-12\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-center heading py-2\",children:id?\"Update Blog\":/*#__PURE__*/_jsx(\"h2\",{children:\"Create Post\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"row h-100 justify-content-center align-items-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-10 col-md-8 col-lg-6\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"row blog-form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-12 py-3\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control input-text-box\",placeholder:\"Title\",name:\"title\",value:title,onChange:handleChange})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-12 py-3\",children:/*#__PURE__*/_jsx(ReactTagInput,{tags:tags,placeholder:\"Tags\",onChange:handleTags})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-12 py-3\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"trending\",children:\"Is it trending blog ?\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-check-inline mx-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",className:\"form-check-input\",value:\"yes\",name:\"radioOption\",checked:trending===\"yes\",onChange:handleTrending}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"radioOption\",className:\"form-check-label\",children:\"Yes\\xA0\"}),/*#__PURE__*/_jsx(\"input\",{type:\"radio\",className:\"form-check-input\",value:\"no\",name:\"radioOption\",checked:trending===\"no\",onChange:handleTrending}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"radioOption\",className:\"form-check-label\",children:\"No\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"col-12 py-3\",children:/*#__PURE__*/_jsxs(\"select\",{value:category,onChange:onCategoryChange,className:\"catg-dropdown\",children:[/*#__PURE__*/_jsx(\"option\",{children:\"Please select category\"}),categoryOption.map(function(option,index){return/*#__PURE__*/_jsx(\"option\",{value:option||\"\",children:option},index);})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-12 py-3\",children:/*#__PURE__*/_jsx(\"textarea\",{className:\"form-control description-box\",placeholder:\"Description\",value:description,name:\"description\",onChange:handleChange})}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:/*#__PURE__*/_jsx(\"input\",{type:\"file\",className:\"form-control\",onChange:function onChange(e){return setFile(e.target.files[0]);}})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-12 py-3 text-center\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-add\",type:\"submit\",disabled:progress!==null&&progress<100,children:id?\"Update\":\"Submit\"})})]})})})]})});};export default AddEditBlog;","map":null,"metadata":{},"sourceType":"module"}